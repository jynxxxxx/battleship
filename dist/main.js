(()=>{var t={75:t=>{class e{constructor(t){this.name=t;const e=[1,2,3,4,5,6,7,8,9,10],o=["A","B","C","D","E","F","G","H","I","J"],s=document.querySelector(".battlefield"),r=document.createElement("div");r.classList.add("boardctn"),"Computer"===this.name?r.classList.add("compBoard"):r.classList.add("playerBoard"),s.appendChild(r);const a=document.createElement("div");a.classList.add("rowlabel");for(let t=0;t<10;t++){const e=document.createElement("div");e.classList.add("label"),e.textContent=o[t],a.appendChild(e)}r.appendChild(a);const i=document.createElement("div");i.classList.add("boardlabel"),"Computer"===this.name?(i.classList.add("comp"),i.textContent="Computer"):(i.classList.add("player"),i.textContent="Player"),r.appendChild(i);const n=document.createElement("div");n.classList.add("columnlabel");for(let t=0;t<10;t++){const e=document.createElement("div");e.classList.add("label"),e.textContent=t+1,n.appendChild(e)}r.appendChild(n);const c=document.createElement("div");c.classList.add("board"),r.appendChild(c);for(let s=0;s<10;s++){const r=document.createElement("div");for(let a=0;a<10;a++){const i=document.createElement("div");i.classList.add("cell"),i.dataset.xcoord=e[a],i.dataset.ycoord=o[s],i.dataset.player=`${t}`,r.appendChild(i)}r.classList.add("row"),c.appendChild(r)}}placeShip(t,e,o,s){if(this.placementValid(t,e,o,s)){for(let r=0;r<t.size;r++){const r=document.querySelector(`.cell[data-xcoord='${e}'][data-ycoord='${o}'][data-player='${this.name}']`);r.classList.add("ship"),t.coordinates.push({x:e,y:o}),r.classList.add(`${t.name}`),s?o=String.fromCharCode(o.charCodeAt(0)+1):e++}return!0}return!1}placementValid(t,e,o,s){if(s&&o.charCodeAt(0)+t.size-65>10)return!1;if(!s&&parseInt(e)+t.size-1>10)return!1;for(let r=0;r<t.size;r++){const t=document.querySelector(`.cell[data-xcoord='${e}'][data-ycoord='${o}'][data-player='${this.name}']`);if(t&&t.classList.contains("ship"))return!1;s?o=String.fromCharCode(o.charCodeAt(0)+1):e++}return!0}randomShipPlacement(t){if("Computer"===this.name){const e=[...t];for(let t=0;t<e.length;t++){const o=e[t];for(;;){const t=String.fromCharCode(65+Math.floor(10*Math.random())),e=Math.floor(10*Math.random())+1,s=Math.random()<.5;if(this.placementValid(o,e,t,s)){this.placeShip(o,e,t,s),console.log(`Placed ship ${o.name}`);break}console.log(`Failed to place ship ${o.name}, retrying...`)}}}}}function o(t,e){const o="A".charCodeAt(0),s="J".charCodeAt(0);return"number"==typeof t&&"string"==typeof e&&(e.charCodeAt(0)>=o&&xCharCode<=s&&t>=1&&t<=10)}t.exports={Ship:class{constructor(t,e){this.name=t,this.size=e,this.coordinates=[],this.hitCount=0,this.sunk=!1}hit(){this.hitCount+=1,this.hitCount===this.size&&(this.sunk=!0)}isSunk(){if(this.size===this.hitCount)return this.sunk=!0,`You sunk the ${this.name}`}},Gameboard:e,Player:class{constructor(t){this.name=t,this.gameboard=new e(t),this.ships=[],this.previousAttacks=new Set,this.lastHit=null,this.directions=["up","down","left","right"],this.currentDirection=""}attackEnemy(t,e){const o=document.querySelector(".text"),s=document.querySelector(`.cell[data-xcoord='${t}'][data-ycoord='${e}'][data-player='Computer']`);let r=Array.from(s.classList);if(r=r.filter((t=>"cell"!==t&&"ship"!==t)),s.classList.contains("ship")){const t=this.ships.find((t=>t.name===r[0]));t.hit(),s.classList.add("hit"),s.textContent="o",o.textContent="It's a hit!",t.isSunk()&&(o.textContent=`You sunk their ${r[0]}`),console.log("hit")}else s.classList.add("miss"),s.textContent="x",o.textContent="It missed",console.log("miss")}receiveAttack(t,e,o){const s=document.querySelector(`.cell[data-xcoord='${t}'][data-ycoord='${e}'][data-player='Player']`),r=document.querySelector(".text");let a=Array.from(s.classList);if(a=a.filter((t=>"cell"!==t&&"ship"!==t)),s.classList.contains("ship")){const i=this.ships.find((t=>t.name===a[0]));return i.hit(),s.classList.add("hit"),s.textContent="o",r.textContent="It's a hit!",o.lastHit={x:t,y:e},console.log(`x: ${o.lastHit.x}, y: ${o.lastHit.y}`),console.log("hit"),i.isSunk()&&(o.lastHit=null,r.textContent=`Enemy sunk your ${a[0]}`),o.lastHit}s.classList.add("miss"),s.textContent="x",r.textContent="It missed",this.currentDirection=this.directions[Math.floor(Math.random()*this.directions.length)],console.log("miss")}hitNextMove(t){const{x:e,y:o}=t;switch(console.log(`currDir: '${this.currentDirection}`),this.currentDirection){case"up":return{x:e-1,y:o};case"down":return{x:e+1,y:o};case"left":return{x:e,y:String.fromCharCode(o.charCodeAt(0)-1)};case"right":return{x:e,y:String.fromCharCode(o.charCodeAt(0)+1)};default:return null}}getDirection(t,e){return t.x===e.x?t.y<e.y?"down":"left":t.y===e.y?t.x<e.x?"right":"up":this.directions[Math.floor(Math.random()*this.directions.length)]}changeDirection(t){switch(t){case"up":return"down";case"down":return"left";case"left":return"right";case"right":return"up";default:return this.directions[Math.floor(Math.random()*this.directions.length)]}}computerAttack(){let t,e;if(this.lastHit?console.log(`Last hit coordinates: x: ${this.lastHit.x}, y: ${this.lastHit.y}`):console.log("No last hit"),this.lastHit){let s=0;for(;s<4;){let r=this.hitNextMove(this.lastHit);if(o(r.x,r.y)&&!this.previousAttacks.has(`${r.x}${r.y}`)){t=r.x,e=r.y,console.log(`Valid! This move: x: ${t}, y: ${e}`);break}this.currentDirection=this.changeDirection(this.currentDirection),console.log(`Changing direction to: ${this.currentDirection}`),r=this.hitNextMove(this.lastHit),s+=1}4===s&&(t=Math.floor(10*Math.random())+1,e=String.fromCharCode(65+Math.floor(10*Math.random())),console.log(`No valid moves after 4 attempts: x: ${t}, y: ${e}`),this.lastHit="",s=0)}else{do{t=Math.floor(10*Math.random())+1,e=String.fromCharCode(65+Math.floor(10*Math.random())),console.log(`Random move: x: ${t}, y: ${e}`),this.currentDirection=this.directions[Math.floor(Math.random()*this.directions.length)]}while(this.previousAttacks.has(`${t}${e}`)||!o(t,e));console.log("No last hit, making a random move")}return this.previousAttacks.add(`${t}${e}`),console.log(`Current direction: ${this.currentDirection}`),{x:t,y:e}}}}}},e={};function o(s){var r=e[s];if(void 0!==r)return r.exports;var a=e[s]={exports:{}};return t[s](a,a.exports,o),a.exports}(()=>{"use strict";var t=o(75);new Promise((e=>{const o=new t.Player("Player"),s=new t.Ship("Carrier",5),r=new t.Ship("Battleship",4),a=new t.Ship("Cruiser",3),i=new t.Ship("Submarine",3),n=new t.Ship("Destroyer",2),c=o.gameboard;o.ships=[s,r,a,i,n];const l=o.ships,d=new t.Ship("Carrier",5),h=new t.Ship("Battleship",4),u=new t.Ship("Cruiser",3),m=new t.Ship("Submarine",3),p=new t.Ship("Destroyer",2),y=new t.Player("Computer");y.ships=[d,h,u,m,p],y.gameboard.randomShipPlacement(y.ships);let v=!0;const f=document.querySelector(".direction");f.addEventListener("click",(()=>{v=!v,f.textContent=v?"Vertical":"Horizontal"}));const C=document.querySelectorAll(".cell");C.forEach((t=>{t.addEventListener("mouseover",L),t.addEventListener("mouseleave",S),t.addEventListener("click",x)}));let g=0;function x(){const t=this,s=t.getAttribute("data-xcoord"),r=t.getAttribute("data-ycoord"),a=t.getAttribute("data-player"),i=l[g];c.placementValid(i,s,r,v)&&"Player"===a&&(c.placeShip(i,s,r,v),g++,g===l.length?(console.log("All player ships have been placed."),e({player1:o,computer:y,done:!0}),C.forEach((function(t){t.removeEventListener("click",x),t.removeEventListener("mouseover",L),t.removeEventListener("mouseleave",S)}))):console.log(`Place ${l[g].name} on the board.`))}function L(){const t=this.getAttribute("data-xcoord"),e=this.getAttribute("data-ycoord"),o=this.getAttribute("data-player"),s=l[g].size;if("Player"===o)if(c.placementValid(l[g],t,e,v))for(let o=0;o<s;o++){let r,a;v?(r=t,a=String.fromCharCode(e.charCodeAt(0)+o)):(console.log("horizontal"),r=parseInt(t)+o,a=e);const i=document.querySelector(`.cell[data-xcoord='${r}'][data-ycoord='${a}'][data-player='Player']`);0===o&&v?i.classList.add("hover1V"):0!==o||v?o===s-1&&v?i.classList.add("hoverEndV"):o!==s-1||v?v?i.classList.add("hoverV"):i.classList.add("hoverH"):i.classList.add("hoverEndH"):i.classList.add("hover1H")}else for(let o=0;o<s;o++){let s,r;v?(s=t,r=String.fromCharCode(e.charCodeAt(0)+o)):(s=parseInt(t)+o,r=e);const a=document.querySelector(`.cell[data-xcoord='${s}'][data-ycoord='${r}'][data-player='Player']`);0===o&&v?a.classList.add("invalid1V"):0!==o||v?v?a.classList.add("invalidV"):a.classList.add("invalidH"):a.classList.add("invalid1H")}this.hoverCells=hoverCells}function S(){console.log("Leave event triggered."),C.forEach((t=>{t.classList.remove("hoverV"),t.classList.remove("hoverH"),t.classList.remove("hover1V"),t.classList.remove("hover1H"),t.classList.remove("hoverEndV"),t.classList.remove("hoverEndH"),t.classList.remove("invalidV"),t.classList.remove("invalidH"),t.classList.remove("invalid1V"),t.classList.remove("invalid1H")}))}return document.querySelector(".start").addEventListener("click",(()=>{const t=document.getElementById("name").value;document.querySelector(".player").textContent=t,o.name=t,function(){const t=document.querySelector(".overlay"),e=document.querySelector(".formcontainer");t.style.display="none",e.innerHTML=""}()})),{player1:o,computer:y}})).then((({player1:t,computer:e,done:o})=>{o?(document.querySelector(".direction").remove(),function(t,e){let o=t,s=!1;function r(){o=o===t?e:t}function a(){t.ships.every((t=>t.isSunk()))&&(s=!0,document.querySelector(".text").textContent=`${e.name} wins! Game over.`),e.ships.every((t=>t.isSunk()))&&(s=!0,console.log("Game over for computer"),document.querySelector(".text").textContent=`${t.name} wins! Game over.`)}const i=document.querySelectorAll(".compBoard .cell"),n=document.querySelector(".text");i.forEach((function(i){i.addEventListener("click",(()=>{if(o===t&&!s){const o=i.getAttribute("data-xcoord"),c=i.getAttribute("data-ycoord");n.textContent=`You attacked ${o}${c}`,setTimeout((()=>{e.attackEnemy(o,c),console.log("playerdone"),a(),r()}),500),setTimeout((()=>{if(!s){const o=e.computerAttack(),s=o.x,i=o.y;n.textContent=`The Enemy attacked ${s}${i}`,setTimeout((()=>{t.receiveAttack(s,i,e),console.log("compdone"),a(),r()}),700)}}),1500),i.removeEventListener("click",this)}}),{once:!0})}))}(t,e),console.log(t),console.log(e)):console.log("Initialization failed: Not all ships are placed.")})).catch((t=>{console.log("Initialization failed:",t)}))})()})();